Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h");if(Parse.User.current()==null){location="login.html"}rg4js("apiKey","5HU2mFdkS/e5Tur8l31gcA==");rg4js("attach",true);rg4js("enablePulse",true);rg4js("setUser",{identifier:Parse.User.current().get("email"),isAnonymous:false,email:Parse.User.current().get("email"),firstName:"Firstname",fullName:"Firstname Lastname"});var Habit=Parse.Object.extend("Habit");var defaultImage=Parse.Object.extend("DefaultImages");var hasImageChanged=false;var hasUploaded=false;function addAlarmToList(d){var c=document.getElementById("alarm-list");var b=document.querySelector("#alarm");var e=document.importNode(b.content,true);e.querySelector(".alarm-name").textContent="Alarm "+d;var a=c.appendChild(e)}function editAlarmToList(g,a,c,f){var e=document.getElementById("alarm-list");var d=document.querySelector("#alarm");var h=document.importNode(d.content,true);h.querySelector(".alarm-name").textContent="Alarm "+g;h.querySelector("#hr1").value=a;h.querySelector("#min1").value=c;h.querySelector("#am1").value=f;var b=e.appendChild(h)}$("input[type='radio']").click(function(){var a=$(this).attr("previousValue");var c=$(this).attr("name");var b=$(this).val();if(a=="checked"){$(this).removeAttr("checked");$(this).attr("previousValue",false)}else{$("input[name="+c+"]:radio").attr("previousValue",false);$(this).attr("previousValue","checked")}var f=document.getElementById("others");f.value="";if(b=="one"){b=1}else{if(b=="two"){b=2}else{if(b=="three"){b=3}}}$("#alarm-list").empty();var e=document.getElementById("myonoffswitch");if(e.checked){for(var d=1;d<=b;d++){addAlarmToList(d)}}});$("#others").change(function(d){$("input[type='radio']").removeAttr("checked");$("#alarm-list").empty();if($("#others").val()<10&&$("#others").val()%1==0&&$("#others").val()>0){var a;a=$("#others").val();var c=document.getElementById("myonoffswitch");if(c.checked){for(var b=1;b<=a;b++){addAlarmToList(b)}}}});function switchNotification(){var c=document.getElementById("myonoffswitch");$("#alarm-list").empty();if(c.checked){var a;if(document.getElementById("once").checked){a=1;for(var b=1;b<=a;b++){addAlarmToList(b)}}else{if(document.getElementById("twice").checked){a=2;for(var b=1;b<=a;b++){addAlarmToList(b)}}else{if(document.getElementById("thrice").checked){a=3;for(var b=1;b<=a;b++){addAlarmToList(b)}}else{if($("#others").val()<10&&$("#others").val()%1==0&&$("#others").val()>0){a=$("#others").val();for(var b=1;b<=a;b++){addAlarmToList(b)}}}}}}}function selectImage(a){document.getElementById("icon1").style.border="none";document.getElementById("icon1").className="icon";document.getElementById("icon2").style.border="none";document.getElementById("icon2").className="icon";document.getElementById("icon3").style.border="none";document.getElementById("icon3").className="icon";document.getElementById("myImg").style.border="none";document.getElementById("myImg").className="icon";var b=document.getElementById(a);b.style.border="5px solid #42A5F5";b.className=b.className+" selectedIcon";fileName=a}function validateForm(){var b=false;var d=false;var c=false;var a=false;if(document.getElementById("title").value==""){document.getElementById("title").style.border="1px solid";document.getElementById("title").style.borderColor="#b94a48"}else{document.getElementById("title").style.border="2px inset";b=true}if($("#icon1, #icon2, #icon3, #myImg").hasClass("selectedIcon")){document.getElementById("noTitle").style.display="none";d=true}else{document.getElementById("noTitle").style.display="block"}if(document.getElementById("isSun").checked){document.getElementById("isSun").className+=" selectedDay"}else{document.getElementById("isSun").className=""}if(document.getElementById("isMon").checked){document.getElementById("isMon").className+=" selectedDay"}else{document.getElementById("isMon").className=""}if(document.getElementById("isTues").checked){document.getElementById("isTues").className+=" selectedDay"}else{document.getElementById("isTues").className=""}if(document.getElementById("isWed").checked){document.getElementById("isWed").className+=" selectedDay"}else{document.getElementById("isWed").className=""}if(document.getElementById("isThurs").checked){document.getElementById("isThurs").className+=" selectedDay"}else{document.getElementById("isThurs").className=""}if(document.getElementById("isFri").checked){document.getElementById("isFri").className+=" selectedDay"}else{document.getElementById("isFri").className=""}if(document.getElementById("isSat").checked){document.getElementById("isSat").className+=" selectedDay"}else{document.getElementById("isSat").className=""}if($("#isSun, #isMon, #isTues, #isWed, #isThurs, #isFri, #isSat").hasClass("selectedDay")){document.getElementById("noFrequency").style.display="none";c=true}else{document.getElementById("noFrequency").style.display="block"}if(document.getElementById("once").checked){document.getElementById("once").className+=" selectedTimesADay"}else{document.getElementById("once").className=""}if(document.getElementById("twice").checked){document.getElementById("twice").className+=" selectedTimesADay"}else{document.getElementById("twice").className=""}if(document.getElementById("thrice").checked){document.getElementById("thrice").className+=" selectedTimesADay"}else{document.getElementById("thrice").className=""}if($("#once, #twice, #thrice").hasClass("selectedTimesADay")&&$("#others").val()!=""){document.getElementById("selectedBothFrequencies").style.display="block";document.getElementById("noDailyFrequency").style.display="none";document.getElementById("others").style.border="2px inset"}else{if(($("#once, #twice, #thrice").hasClass("selectedTimesADay")&&$("#others").val()=="")||(!($("#once, #twice, #thrice").hasClass("selectedTimesADay"))&&$("#others").val()!=""&&$("#others").val()<10&&$("#others").val()>0&&$("#others").val()%1==0)){document.getElementById("selectedBothFrequencies").style.display="none";document.getElementById("noDailyFrequency").style.display="none";document.getElementById("others").style.border="2px inset";a=true}else{document.getElementById("others").style.border="1px solid";document.getElementById("others").style.borderColor="#b94a48";document.getElementById("noDailyFrequency").style.display="block";document.getElementById("selectedBothFrequencies").style.display="none"}}if(b&&d&&c&&a){updateHabit()}}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=new RegExp("[\\?&]"+a+"=([^&#]*)"),b=c.exec(location.search);return b===null?"":decodeURIComponent(b[1].replace(/\+/g," "))}function hasClass(b,a){return(" "+b.className+" ").indexOf(" "+a+" ")>-1}function selectImage(a){if(a=="myImg"&&!hasUploaded){hasImageChanged=false}else{hasImageChanged=true}document.getElementById("icon1").className="icon";document.getElementById("icon2").className="icon";document.getElementById("icon3").className="icon";document.getElementById("myImg").className="icon";var b=document.getElementById(a);b.className=b.className+" selectedIcon"}function uploadIcon(){var b=document.getElementById("myFile");var a="";if("files" in b){if(b.files.length==0){a="Select one or more files."}else{for(var d=0;d<b.files.length;d++){a+="<br><strong>"+(d+1)+". file</strong><br>";var c=b.files[d];if("name" in c){a+="name: "+c.name+"<br>"}if("size" in c){a+="size: "+c.size+" bytes <br>"}}}}else{if(b.value==""){a+="Select one or more files."}else{a+="The files property is not supported by your browser!";a+="<br>The path of the selected file: "+b.value}}}$(function(){$(":file").change(function(){if(this.files&&this.files[0]){var a=new FileReader();a.onload=imageIsLoaded;a.readAsDataURL(this.files[0])}})});function imageIsLoaded(a){$(".hide").css("display","inline-block");$("#myImg").attr("src",a.target.result);hasUploaded=true;selectImage("myImg")}function onStart(){var a=new Parse.Query(Habit);editHabitID=getParameterByName("id");if(editHabitID==null||editHabitID==""){location="list.html"}a.get(editHabitID,{success:function(e){document.getElementById("title").value=e.get("name");document.getElementById("isSun").checked=e.get("onSunday");document.getElementById("isMon").checked=e.get("onMonday");document.getElementById("isTues").checked=e.get("onTuesday");document.getElementById("isWed").checked=e.get("onWednesday");document.getElementById("isThurs").checked=e.get("onThursday");document.getElementById("isFri").checked=e.get("onFriday");document.getElementById("isSat").checked=e.get("onSaturday");var g=e.get("frequency");if(g<=3){switch(g){case 1:document.getElementById("once").checked=true;break;case 2:document.getElementById("twice").checked=true;break;case 3:document.getElementById("thrice").checked=true;break;default:}}else{document.getElementById("others").value=""+g}var k=e.get("alarms");if(k.length==0){document.getElementById("myonoffswitch").checked=false}var h;var j;var d;var c;for(var f=0;f<k.length;++f){c=k[f].substring(0,2);if(c>11&&c<24){h="pm"}else{h="am"}if(c>12){j=c-12}else{if(c>=10){j=c}else{if(c=="00"){j="12"}else{j=k[f].substring(1,2)}}}d=k[f].substring(3,5);editAlarmToList(f+1,j,d,h)}var b=e.get("icon");if(b){document.getElementById("myImg").src=b.url()}switch(e.get("defaultIconID")){case"0JrjvKGnbG":selectImage("icon1");break;case"zgGDtotXrU":selectImage("icon2");break;case"qww3v520kk":selectImage("icon3");break;case"none":$(".hide").css("display","inline-block");selectImage("myImg");break;default:}},error:function(c,b){console.log("Habit object was not retrieved successfully!")}})}function updateHabit(){var a=new Parse.Query(Habit);a.get(getParameterByName("id"),{success:function(h){h.set("name",document.getElementById("title").value);h.set("onSunday",document.getElementById("isSun").checked);h.set("onMonday",document.getElementById("isMon").checked);h.set("onTuesday",document.getElementById("isTues").checked);h.set("onWednesday",document.getElementById("isWed").checked);h.set("onThursday",document.getElementById("isThurs").checked);h.set("onFriday",document.getElementById("isFri").checked);h.set("onSaturday",document.getElementById("isSat").checked);var q=document.getElementById("others").value;var o;if(!(q==null||q=="")){o=Number(q)}else{if(document.getElementById("once").checked){o=1}else{if(document.getElementById("twice").checked){o=2}else{if(document.getElementById("thrice").checked){o=3}}}}if(h.get("numCompleted")>o){h.set("numCompleted",o)}if(h.get("thumbCtr")>o){h.set("thumbCtr",o)}h.set("frequency",o);var e=[];var p="";var j="";var m=document.getElementById("alarm-list");var r=m.getElementsByTagName("li");for(var l=0;l<r.length;++l){p=parseInt(r[l].querySelector("#hr1").value);j=parseInt(r[l].querySelector("#min1").value);p=p%12;if(r[l].querySelector("#am1").value=="pm"){p+=12}p=("0"+p).slice(-2);j=("0"+j).slice(-2);e.push(p+":"+j)}h.set("alarms",e);var f;var k;if(hasClass(document.getElementById("icon1"),"selectedIcon")){f="icon1";k="0JrjvKGnbG"}else{if(hasClass(document.getElementById("icon2"),"selectedIcon")){f="icon2";k="zgGDtotXrU"}else{if(hasClass(document.getElementById("icon3"),"selectedIcon")){f="icon3";k="qww3v520kk"}else{if(hasClass(document.getElementById("myImg"),"selectedIcon")){f="userUpload";k="none"}}}}h.set("defaultIconID",k);if(f=="icon1"||f=="icon2"||f=="icon3"){var n=new Parse.Query(defaultImage);n.get(k,{success:function(i){h.set("icon",i.get("icon"));h.save(null,{success:function(s){location="list.html"},error:function(s,t){alert("Failed to update object, with error code: "+t.message)}})},error:function(s,i){}})}else{if(hasImageChanged&&f=="userUpload"){var b=$("#iconFileUpload")[0];if(b.files.length>0){var g=b.files[0];var d="icon.jpg";var c=new Parse.File(d,g)}c.save().then(function(){},function(i){});h.set("icon",c);h.save(null,{success:function(i){location="list.html"},error:function(i,s){alert("Failed to update object, with error code: "+s.message)}})}else{h.save();location="list.html"}}},error:function(c,b){console.log("Habit object was not retrieved successfully!")}})}$(window).resize(function(){if($(".hide").css("display")!="none"){if($("#form").width()<360){$(".hide").css("display","block");$(".hide").css("position","relative")}else{$(".hide").css("position","absolute");$(".hide").css("display","inline-block");var a=document.getElementById("editForm");var b=a.innerHTML;a.innerHTML=b}}});window.onload=onStart;