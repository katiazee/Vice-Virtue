function addAlarmToList(e){var t=document.getElementById("alarm-list"),n=document.querySelector("#alarm"),o=document.importNode(n.content,!0);o.querySelector(".alarm-name").textContent="Alarm "+e,t.appendChild(o)}function switchNotification(){var e=document.getElementById("myonoffswitch");if($("#alarm-list").empty(),e.checked){var t;if(document.getElementById("once").checked){t=1;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(document.getElementById("twice").checked){t=2;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(document.getElementById("thrice").checked){t=3;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(10>$("#others").val()&&0==$("#others").val()%1&&$("#others").val()>0){t=$("#others").val();for(var n=1;t>=n;n++)addAlarmToList(n)}}}function selectImage(e){document.getElementById("icon1").style.border="none",document.getElementById("icon1").className="icon",document.getElementById("icon2").style.border="none",document.getElementById("icon2").className="icon",document.getElementById("icon3").style.border="none",document.getElementById("icon3").className="icon",document.getElementById("myImg").style.border="none",document.getElementById("myImg").className="icon";var t=document.getElementById(e);t.style.border="5px solid #42A5F5",t.className=t.className+" selectedIcon",fileName=e}function validateForm(){var e=!1,t=!1,n=!1,o=!1;""==document.getElementById("title").value?(document.getElementById("title").style.border="1px solid",document.getElementById("title").style.borderColor="#b94a48"):(document.getElementById("title").style.border="2px inset",e=!0),$("#icon1, #icon2, #icon3, #myImg").hasClass("selectedIcon")?(document.getElementById("noTitle").style.display="none",t=!0):document.getElementById("noTitle").style.display="block",document.getElementById("isSun").checked?document.getElementById("isSun").className+=" selectedDay":document.getElementById("isSun").className="",document.getElementById("isMon").checked?document.getElementById("isMon").className+=" selectedDay":document.getElementById("isMon").className="",document.getElementById("isTues").checked?document.getElementById("isTues").className+=" selectedDay":document.getElementById("isTues").className="",document.getElementById("isWed").checked?document.getElementById("isWed").className+=" selectedDay":document.getElementById("isWed").className="",document.getElementById("isThurs").checked?document.getElementById("isThurs").className+=" selectedDay":document.getElementById("isThurs").className="",document.getElementById("isFri").checked?document.getElementById("isFri").className+=" selectedDay":document.getElementById("isFri").className="",document.getElementById("isSat").checked?document.getElementById("isSat").className+=" selectedDay":document.getElementById("isSat").className="",$("#isSun, #isMon, #isTues, #isWed, #isThurs, #isFri, #isSat").hasClass("selectedDay")?(document.getElementById("noFrequency").style.display="none",n=!0):document.getElementById("noFrequency").style.display="block",document.getElementById("once").checked?document.getElementById("once").className+=" selectedTimesADay":document.getElementById("once").className="",document.getElementById("twice").checked?document.getElementById("twice").className+=" selectedTimesADay":document.getElementById("twice").className="",document.getElementById("thrice").checked?document.getElementById("thrice").className+=" selectedTimesADay":document.getElementById("thrice").className="",$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""!=$("#others").val()?(document.getElementById("selectedBothFrequencies").style.display="block",document.getElementById("noDailyFrequency").style.display="none",document.getElementById("others").style.border="2px inset"):$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""==$("#others").val()||!$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""!=$("#others").val()&&10>$("#others").val()&&0==$("#others").val()%1?(document.getElementById("selectedBothFrequencies").style.display="none",document.getElementById("noDailyFrequency").style.display="none",document.getElementById("others").style.border="2px inset",o=!0):(document.getElementById("others").style.border="1px solid",document.getElementById("others").style.borderColor="#b94a48",document.getElementById("noDailyFrequency").style.display="block",document.getElementById("selectedBothFrequencies").style.display="none"),e&&t&&n&&o&&addHabit()}function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function addHabit(){var e=new Habit,t=Parse.User.current();e.set("username",t.get("username")),e.set("name",document.getElementById("title").value),e.set("onSunday",document.getElementById("isSun").checked),e.set("onMonday",document.getElementById("isMon").checked),e.set("onTuesday",document.getElementById("isTues").checked),e.set("onWednesday",document.getElementById("isWed").checked),e.set("onThursday",document.getElementById("isThurs").checked),e.set("onFriday",document.getElementById("isFri").checked),e.set("onSaturday",document.getElementById("isSat").checked),e.set("currStreak",0),e.set("bestStreak",0);var n=new Date,o=n.getUTCMonth()+1,s=n.getUTCDate(),a=n.getUTCFullYear();e.set("currDate",o+"/"+s+"/"+a),e.set("currDay",n.getDay());var l,c=document.getElementById("others").value;null!=c&&""!=c?l=Number(c):document.getElementById("once").checked?l=1:document.getElementById("twice").checked?l=2:document.getElementById("thrice").checked&&(l=3),e.set("frequency",l),e.set("numCompleted",0),e.set("thumbCtr",0);for(var d=[],r="",i="",m=document.getElementById("alarm-list"),u=m.getElementsByTagName("li"),y=0;u.length>y;++y)r=parseInt(u[y].querySelector("#hr1").value),i=parseInt(u[y].querySelector("#min1").value),r%=12,"pm"==u[y].querySelector("#am1").value&&(r+=12),r=("0"+r).slice(-2),i=("0"+i).slice(-2),d.push(r+":"+i);e.set("alarms",d);var g,h;if(hasClass(document.getElementById("icon1"),"selectedIcon")?(g="icon1",h="0JrjvKGnbG"):hasClass(document.getElementById("icon2"),"selectedIcon")?(g="icon2",h="zgGDtotXrU"):hasClass(document.getElementById("icon3"),"selectedIcon")?(g="icon3",h="qww3v520kk"):hasClass(document.getElementById("myImg"),"selectedIcon")&&(g="userUpload",h="none"),e.set("defaultIconID",h),"icon1"==g||"icon2"==g||"icon3"==g){var b=new Parse.Query(defaultImage);b.get(h,{success:function(t){e.set("icon",t.get("icon")),e.save(null,{success:function(){location="list.html"},error:function(e,t){alert("Failed to create new object, with error code: "+t.message)}})},error:function(){}})}else if("userUpload"==g){var I=$("#iconFileUpload")[0];if(I.files.length>0)var f=I.files[0],p="icon.jpg",E=new Parse.File(p,f);E.save().then(function(){},function(){}),e.set("icon",E),e.save(null,{success:function(){location="list.html"},error:function(e,t){alert("Failed to create new object, with error code: "+t.message)}})}}function uploadIcon(){var e=document.getElementById("myFile"),t="";if("files"in e)if(0==e.files.length)t="Select one or more files.";else for(var n=0;e.files.length>n;n++){t+="<br><strong>"+(n+1)+". file</strong><br>";var o=e.files[n];"name"in o&&(t+="name: "+o.name+"<br>"),"size"in o&&(t+="size: "+o.size+" bytes <br>")}else""==e.value?t+="Select one or more files.":(t+="The files property is not supported by your browser!",t+="<br>The path of the selected file: "+e.value)}function imageIsLoaded(e){$(".hide").css("display","inline-block"),$("#myImg").attr("src",e.target.result),selectImage("myImg")}function addAlarmToList(e){var t=document.getElementById("alarm-list"),n=document.querySelector("#alarm"),o=document.importNode(n.content,!0);o.querySelector(".alarm-name").textContent="Alarm "+e,t.appendChild(o)}function editAlarmToList(e,t,n,o){var s=document.getElementById("alarm-list"),a=document.querySelector("#alarm"),l=document.importNode(a.content,!0);l.querySelector(".alarm-name").textContent="Alarm "+e,l.querySelector("#hr1").value=t,l.querySelector("#min1").value=n,l.querySelector("#am1").value=o,s.appendChild(l)}function switchNotification(){var e=document.getElementById("myonoffswitch");if($("#alarm-list").empty(),e.checked){var t;if(document.getElementById("once").checked){t=1;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(document.getElementById("twice").checked){t=2;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(document.getElementById("thrice").checked){t=3;for(var n=1;t>=n;n++)addAlarmToList(n)}else if(10>$("#others").val()&&0==$("#others").val()%1&&$("#others").val()>0){t=$("#others").val();for(var n=1;t>=n;n++)addAlarmToList(n)}}}function selectImage(e){document.getElementById("icon1").style.border="none",document.getElementById("icon1").className="icon",document.getElementById("icon2").style.border="none",document.getElementById("icon2").className="icon",document.getElementById("icon3").style.border="none",document.getElementById("icon3").className="icon",document.getElementById("myImg").style.border="none",document.getElementById("myImg").className="icon";var t=document.getElementById(e);t.style.border="5px solid #42A5F5",t.className=t.className+" selectedIcon",fileName=e}function validateForm(){var e=!1,t=!1,n=!1,o=!1;""==document.getElementById("title").value?(document.getElementById("title").style.border="1px solid",document.getElementById("title").style.borderColor="#b94a48"):(document.getElementById("title").style.border="2px inset",e=!0),$("#icon1, #icon2, #icon3, #myImg").hasClass("selectedIcon")?(document.getElementById("noTitle").style.display="none",t=!0):document.getElementById("noTitle").style.display="block",document.getElementById("isSun").checked?document.getElementById("isSun").className+=" selectedDay":document.getElementById("isSun").className="",document.getElementById("isMon").checked?document.getElementById("isMon").className+=" selectedDay":document.getElementById("isMon").className="",document.getElementById("isTues").checked?document.getElementById("isTues").className+=" selectedDay":document.getElementById("isTues").className="",document.getElementById("isWed").checked?document.getElementById("isWed").className+=" selectedDay":document.getElementById("isWed").className="",document.getElementById("isThurs").checked?document.getElementById("isThurs").className+=" selectedDay":document.getElementById("isThurs").className="",document.getElementById("isFri").checked?document.getElementById("isFri").className+=" selectedDay":document.getElementById("isFri").className="",document.getElementById("isSat").checked?document.getElementById("isSat").className+=" selectedDay":document.getElementById("isSat").className="",$("#isSun, #isMon, #isTues, #isWed, #isThurs, #isFri, #isSat").hasClass("selectedDay")?(document.getElementById("noFrequency").style.display="none",n=!0):document.getElementById("noFrequency").style.display="block",document.getElementById("once").checked?document.getElementById("once").className+=" selectedTimesADay":document.getElementById("once").className="",document.getElementById("twice").checked?document.getElementById("twice").className+=" selectedTimesADay":document.getElementById("twice").className="",document.getElementById("thrice").checked?document.getElementById("thrice").className+=" selectedTimesADay":document.getElementById("thrice").className="",$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""!=$("#others").val()?(document.getElementById("selectedBothFrequencies").style.display="block",document.getElementById("noDailyFrequency").style.display="none",document.getElementById("others").style.border="2px inset"):$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""==$("#others").val()||!$("#once, #twice, #thrice").hasClass("selectedTimesADay")&&""!=$("#others").val()&&10>$("#others").val()&&$("#others").val()>0&&0==$("#others").val()%1?(document.getElementById("selectedBothFrequencies").style.display="none",document.getElementById("noDailyFrequency").style.display="none",document.getElementById("others").style.border="2px inset",o=!0):(document.getElementById("others").style.border="1px solid",document.getElementById("others").style.borderColor="#b94a48",document.getElementById("noDailyFrequency").style.display="block",document.getElementById("selectedBothFrequencies").style.display="none"),e&&t&&n&&o&&updateHabit()}function getParameterByName(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=RegExp("[\\?&]"+e+"=([^&#]*)"),n=t.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function hasClass(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function selectImage(e){hasImageChanged="myImg"!=e||hasUploaded?!0:!1,document.getElementById("icon1").className="icon",document.getElementById("icon2").className="icon",document.getElementById("icon3").className="icon",document.getElementById("myImg").className="icon";var t=document.getElementById(e);t.className=t.className+" selectedIcon"}function uploadIcon(){var e=document.getElementById("myFile"),t="";if("files"in e)if(0==e.files.length)t="Select one or more files.";else for(var n=0;e.files.length>n;n++){t+="<br><strong>"+(n+1)+". file</strong><br>";var o=e.files[n];"name"in o&&(t+="name: "+o.name+"<br>"),"size"in o&&(t+="size: "+o.size+" bytes <br>")}else""==e.value?t+="Select one or more files.":(t+="The files property is not supported by your browser!",t+="<br>The path of the selected file: "+e.value)}function imageIsLoaded(e){$(".hide").css("display","inline-block"),$("#myImg").attr("src",e.target.result),hasUploaded=!0,selectImage("myImg")}function onStart(){var e=new Parse.Query(Habit);editHabitID=getParameterByName("id"),(null==editHabitID||""==editHabitID)&&(location="list.html"),e.get(editHabitID,{success:function(e){document.getElementById("title").value=e.get("name"),document.getElementById("isSun").checked=e.get("onSunday"),document.getElementById("isMon").checked=e.get("onMonday"),document.getElementById("isTues").checked=e.get("onTuesday"),document.getElementById("isWed").checked=e.get("onWednesday"),document.getElementById("isThurs").checked=e.get("onThursday"),document.getElementById("isFri").checked=e.get("onFriday"),document.getElementById("isSat").checked=e.get("onSaturday");var t=e.get("frequency");if(3>=t)switch(t){case 1:document.getElementById("once").checked=!0;break;case 2:document.getElementById("twice").checked=!0;break;case 3:document.getElementById("thrice").checked=!0;break;default:}else document.getElementById("others").value=""+t;var n=e.get("alarms");0==n.length&&(document.getElementById("myonoffswitch").checked=!1);for(var o,s,a,l,c=0;n.length>c;++c)l=n[c].substring(0,2),o=l>11&&24>l?"pm":"am",s=l>12?l-12:l>=10?l:"00"==l?"12":n[c].substring(1,2),a=n[c].substring(3,5),editAlarmToList(c+1,s,a,o);var d=e.get("icon");switch(d&&(document.getElementById("myImg").src=d.url()),e.get("defaultIconID")){case"0JrjvKGnbG":selectImage("icon1");break;case"zgGDtotXrU":selectImage("icon2");break;case"qww3v520kk":selectImage("icon3");break;case"none":$(".hide").css("display","inline-block"),selectImage("myImg");break;default:}},error:function(){console.log("Habit object was not retrieved successfully!")}})}function updateHabit(){var e=new Parse.Query(Habit);e.get(getParameterByName("id"),{success:function(e){e.set("name",document.getElementById("title").value),e.set("onSunday",document.getElementById("isSun").checked),e.set("onMonday",document.getElementById("isMon").checked),e.set("onTuesday",document.getElementById("isTues").checked),e.set("onWednesday",document.getElementById("isWed").checked),e.set("onThursday",document.getElementById("isThurs").checked),e.set("onFriday",document.getElementById("isFri").checked),e.set("onSaturday",document.getElementById("isSat").checked);var t,n=document.getElementById("others").value;null!=n&&""!=n?t=Number(n):document.getElementById("once").checked?t=1:document.getElementById("twice").checked?t=2:document.getElementById("thrice").checked&&(t=3),e.get("numCompleted")>t&&e.set("numCompleted",t),e.get("thumbCtr")>t&&e.set("thumbCtr",t),e.set("frequency",t);for(var o=[],s="",a="",l=document.getElementById("alarm-list"),c=l.getElementsByTagName("li"),d=0;c.length>d;++d)s=parseInt(c[d].querySelector("#hr1").value),a=parseInt(c[d].querySelector("#min1").value),s%=12,"pm"==c[d].querySelector("#am1").value&&(s+=12),s=("0"+s).slice(-2),a=("0"+a).slice(-2),o.push(s+":"+a);e.set("alarms",o);var r,i;if(hasClass(document.getElementById("icon1"),"selectedIcon")?(r="icon1",i="0JrjvKGnbG"):hasClass(document.getElementById("icon2"),"selectedIcon")?(r="icon2",i="zgGDtotXrU"):hasClass(document.getElementById("icon3"),"selectedIcon")?(r="icon3",i="qww3v520kk"):hasClass(document.getElementById("myImg"),"selectedIcon")&&(r="userUpload",i="none"),e.set("defaultIconID",i),"icon1"==r||"icon2"==r||"icon3"==r){var m=new Parse.Query(defaultImage);m.get(i,{success:function(t){e.set("icon",t.get("icon")),e.save(null,{success:function(){location="list.html"},error:function(e,t){alert("Failed to update object, with error code: "+t.message)}})},error:function(){}})}else if(hasImageChanged&&"userUpload"==r){var u=$("#iconFileUpload")[0];if(u.files.length>0)var y=u.files[0],g="icon.jpg",h=new Parse.File(g,y);h.save().then(function(){},function(){}),e.set("icon",h),e.save(null,{success:function(){location="list.html"},error:function(e,t){alert("Failed to update object, with error code: "+t.message)}})}else e.save(),location="list.html"},error:function(){console.log("Habit object was not retrieved successfully!")}})}function showMsg(e){var t=e.parentNode.parentNode.getElementsByClassName("message")[0];t.style.visibility="visible"}function compareDates(e,t){var n=e.split("/"),o=t.split("/");return n[2]>o[2]?1:n[2]<o[2]?-1:n[0]>o[0]?1:n[0]<o[0]?-1:n[1]>o[1]?1:n[1]<o[1]?-1:0}function editHabit(e){location="edit.html?id="+e.parentNode.parentNode.getAttribute("data-id")}function deleteHabit(e){var t=e.parentNode.parentNode;t.parentNode;var n=new Parse.Query(Habit),o=confirm("Are you sure you want to delete this habit?");1==o&&n.get(t.getAttribute("data-id"),{success:function(t){t.destroy({success:function(){$(e.parentNode.parentNode).fadeOut(400,function(){$(this).remove()})},error:function(){alert("There was an error deleting this habit; please try again.")}})},error:function(){alert("There was an error deleting this habit; please try again.")}})}function days(e,t){checkDay("onSunday",e,t),checkDay("onMonday",e,t),checkDay("onTuesday",e,t),checkDay("onWednesday",e,t),checkDay("onThursday",e,t),checkDay("onFriday",e,t),checkDay("onSaturday",e,t)}function checkDay(e,t,n){var o=t.get(e),s=new Date,a=s.getDay();if(o)switch(e){case"onSunday":0==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onSunday").style.color="black",n.querySelector("#onSunday").style.fontWeight="bold";break;case"onMonday":1==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onMonday").style.color="black",n.querySelector("#onMonday").style.fontWeight="bold";break;case"onTuesday":2==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onTuesday").style.color="black",n.querySelector("#onTuesday").style.fontWeight="bold";break;case"onWednesday":3==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onWednesday").style.color="black",n.querySelector("#onWednesday").style.fontWeight="bold";break;case"onThursday":4==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onThursday").style.color="black",n.querySelector("#onThursday").style.fontWeight="bold";break;case"onFriday":5==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onFriday").style.color="black",n.querySelector("#onFriday").style.fontWeight="bold";break;case"onSaturday":6==a&&(n.getElementById("thumbsUp").className=n.getElementById("thumbsUp").className+" enableThumbsUp",n.getElementById("thumbsDown").className=n.getElementById("thumbsDown").className+" enableThumbsDown"),n.querySelector("#onSaturday").style.color="black",n.querySelector("#onSaturday").style.fontWeight="bold"}}function streak(e,t){var n,o=e.get("currStreak"),s=e.get("bestStreak");if(0==s)n=0;else var n=200*(o/s);$(t).find("#progressBar").find("div").animate({width:n},500),200==n?$(t).find("#progressBar").find("div").css("background","#009900"):$(t).find("#progressBar").find("div").css("background","#0099ff")}function updateStreakFromButton(e,t){var n,o=e.get("currStreak"),s=e.get("bestStreak");if(0==s)n=0;else var n=200*(o/s);$(t).find("#progressBar").find("div").animate({width:n},500),200==n?$(t).find("#progressBar").find("div").css("background","#009900"):$(t).find("#progressBar").find("div").css("background","#0099ff")}function addHabitToList(e){var t=document.getElementById("habit-list"),n=document.querySelector("#habit-template");n.content||notSupported();var o=document.importNode(n.content,!0);o.firstElementChild.setAttribute("data-id",e.id),days(e,o),streak(e,o);var s=e.get("icon");s&&(o.querySelector(".habit-icon").src=s.url());var a=e.get("currDate"),l=new Date(a),c=new Date,d=c.getUTCMonth()+1,r=c.getUTCDate(),i=c.getUTCFullYear(),m=d+"/"+r+"/"+i,u=c.getDay();if(e.get(daysBoolArr[u])?showMsg(o.querySelector(".op-done")):(o.querySelector(".message-today").className=o.querySelector(".message-today").className+" hide",o.querySelector(".message-missed").className=o.querySelector(".message-missed").className+" hide"),0!=compareDates(a,m)){e.get("thumbCtr")!=e.get("frequency")&&e.get("numCompleted")<e.get("frequency")&&e.set("currStreak",0),e.set("thumbCtr",0),e.set("numCompleted",0);for(var y=0,g=e.get("currDay");7>=y&&(g=(g+1)%7,y++,!e.get(daysBoolArr[g])););l.setDate(l.getDate()+y);var h=l.getUTCMonth()+1+"/"+l.getUTCDate()+"/"+l.getUTCFullYear();1==compareDates(m,h)&&e.set("currStreak",0),e.set("currDate",m),e.set("currDay",u),e.save(),streak(e,o)}else e.get("thumbCtr")==e.get("frequency")&&(o.querySelector(".op-done").className="op op-done",o.querySelector(".op-down").className="op op-down");o.querySelector(".habit-name").textContent=e.get("name"),o.querySelector(".currStreak").textContent=e.get("currStreak"),o.querySelector(".bestStreak").textContent=e.get("bestStreak"),o.querySelector(".frequencyPerDay").textContent=e.get("frequency"),o.querySelector(".completed").textContent=e.get("numCompleted"),o.querySelector(".missed").textContent=e.get("thumbCtr")-e.get("numCompleted"),t.appendChild(o)}function completeHabit(e){var t=e.parentNode.parentNode.getAttribute("data-id"),n=new Parse.Query(Habit);n.get(t,{success:function(t){var n=t.get("numCompleted"),o=t.get("thumbCtr"),s=t.get("frequency"),a=t.get("currStreak"),l=t.get("bestStreak");s>o&&(o++,n++,a++,a>l&&(l=a),t.set("numCompleted",n),t.set("thumbCtr",o),t.set("currStreak",a),t.set("bestStreak",l),t.save(null,{success:function(t){e.parentNode.parentNode.querySelector(".currStreak").textContent=t.get("currStreak"),e.parentNode.parentNode.querySelector(".bestStreak").textContent=t.get("bestStreak"),e.parentNode.parentNode.querySelector(".completed").textContent=t.get("numCompleted"),e.parentNode.parentNode.querySelector(".missed").textContent=t.get("thumbCtr")-t.get("numCompleted"),updateStreakFromButton(t,e.parentNode.parentNode)},error:function(){alert("Unable to update habit!  Please check your network connection and try again later.")}})),o==s&&(e.parentNode.parentNode.querySelector("#thumbsUp").className="op op-done",e.parentNode.parentNode.querySelector("#thumbsDown").className="op op-down")},error:function(){console.log("Habit object was not retrieved successfully!"),alert("Unable to update habit!  Please check your network connection and try again later.")}})}function failHabit(e){var t=e.parentNode.parentNode.getAttribute("data-id"),n=new Parse.Query(Habit);n.get(t,{success:function(t){var n=t.get("thumbCtr"),o=t.get("frequency");o>n&&(n++,t.set("thumbCtr",n),t.set("currStreak",0),t.save(null,{success:function(t){e.parentNode.parentNode.querySelector(".currStreak").textContent=t.get("currStreak"),e.parentNode.parentNode.querySelector(".missed").textContent=t.get("thumbCtr")-t.get("numCompleted"),updateStreakFromButton(t,e.parentNode.parentNode)},error:function(){alert("Unable to update habit!  Please check your network connection and try again later.")}})),n==o&&(e.parentNode.parentNode.querySelector("#thumbsUp").className="op op-done",e.parentNode.parentNode.querySelector("#thumbsDown").className="op op-down")},error:function(){alert("Unable to update habit!  Please check your network connection and try again later.")}})}function logOff(){Parse.User.logOut(),location="login.html"}function loadHabits(){var e=new Parse.Query(Habit),t=Parse.User.current();e.equalTo("username",t.get("username")),e.find({success:function(e){for(var t=0;e.length>t;t++)addHabitToList(e[t]);$(".hidden-resizer").each(function(){for(;$(this).width()>$(".title-li").width();){var e=parseInt($(this).css("font-size"),10);$(this).css("font-size",e-1)}})},error:function(e){alert("Error: "+e.code+" "+e.message)}})}function notSupported(){document.getElementById("notSupported").style.display="block",alert("This website doesn't support your browser. Only Chrome, Safari, and Firefox are supported.")}function onClickSignUp(){var e=document.getElementById("signInMessage");e.style.display="block"}function signIn(){var e=document.getElementById("usermail").value,t=document.getElementById("password").value;document.getElementById("usermail").className="textInput",document.getElementById("password").className="textInput",document.getElementById("invalidLoginError").style.display="none",Parse.User.logIn(e,t,{success:function(){location="welcome.html"},error:function(){document.getElementById("usermail").className=document.getElementById("usermail").className+" inputError",document.getElementById("password").className=document.getElementById("password").className+" inputError",document.getElementById("invalidLoginError").style.display="block"}})}function initialiseState(){return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?(document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Enable notifications in your browser in order to receive push notifications",void 0):"PushManager"in window?void 0:(document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Push notifications are not supported in your browser",void 0):(console.warn("Notifications aren't supported."),document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),void 0)}function subscribe(){console.log("subscribing");var e=document.querySelector(".onoffswitch-checkbox");navigator.serviceWorker.ready.then(function(t){t.pushManager.getSubscription().then(function(e){var n=document.querySelector(".onoffswitch-checkbox");return n.disabled=!1,e?(console.log(e),sendSubscriptionToServer(e),isPushEnabled=!0,void 0):(t.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){console.log("here - success"),console.log("endpoint:",e.endpoint),isPushEnabled=!0,console.log(e),sendSubscriptionToServer(e)}).catch(function(e){"denied"===Notification.permission?(document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Enable notifications in your browser in order to receive push notifications",n.disabled=!0):(document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Unfortunately, we were unable to enable notifications",console.log(e))}),void 0)}).catch(function(t){console.warn("Error during getSubscription()",t),document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!1),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Unfortunately, we were unable to enable notifications",e.disabled=!0})})}function sendSubscriptionToServer(e){console.log(e),console.log("endpoint:",e.endpoint),$.ajax({url:"https://vice-virtue.herokuapp.com/subscribe",type:"POST",data:{endpoint:e.endpoint},dataType:"json",success:function(e){switch(e){case!0:processResponse(e);break;default:resultDiv.html(e)}},error:function(){}})}function onButtonClick(){document.getElementById("yesEmail").style.display="none",document.getElementById("invalidEmail").style.display="none",validateEmail()&&resetPass()}function resetPass(){Parse.User.requestPasswordReset(document.getElementById("validEmail").value,{success:function(){document.getElementById("yesEmail").style.display="block",document.getElementById("validEmail").style.border="2px inset"},error:function(e){console.log("Error: "+e.code+" "+e.message),125==e.code&&(document.getElementById("invalidEmail").style.display="block",document.getElementById("validEmail").style.border="1px solid",document.getElementById("validEmail").style.borderColor="#b94a48")}})}function validateEmail(){var e=document.getElementById("validEmail");return""==e.value?(e.style.border="1px solid",e.style.borderColor="#b94a48",document.getElementById("noEmail").style.display="block",!1):(document.getElementById("noEmail").style.display="none",e.style.border="2px inset",!0)}function onSignUpPress(){var e=validateEmail();validatePassword()&&e&&registerAccount()}function verifyPasswords(){var e=document.getElementById("validPass").value,t=document.getElementById("validConfirmPass").value;return""==e||""==t?!1:e==t?(document.getElementById("passwordsMismatch").style.display="none",document.getElementById("validConfirmPass").style.border="2px inset",!0):(document.getElementById("validConfirmPass").style.border="1px solid",document.getElementById("validConfirmPass").style.borderColor="#b94a48",document.getElementById("passwordsMismatch").style.display="block",void 0)}function validateEmail(){var e=document.getElementById("validEmail");return document.getElementById("emailTaken").style.display="none",e.style.border="2px inset",""==e.value?(e.style.border="1px solid",e.style.borderColor="#b94a48",document.getElementById("noEmail").style.display="block",!1):(document.getElementById("noEmail").style.display="none",e.style.border="2px inset",!0)}function validatePassword(){var e=document.getElementById("validPass"),t=document.getElementById("validConfirmPass"),n=!0;return document.getElementById("passwordsMismatch").style.display="none",document.getElementById("validConfirmPass").style.border="2px inset",""==e.value?(e.style.border="1px solid",e.style.borderColor="#b94a48",document.getElementById("noPass").style.display="block",n=!1):(e.style.border="2px inset",document.getElementById("noPass").style.display="none"),""==t.value?(t.style.border="1px solid",t.style.borderColor="#b94a48",document.getElementById("noConfirmPass").style.display="block",n=!1):(document.getElementById("noConfirmPass").style.display="none",t.style.border="2px inset"),n&&(n=verifyPasswords()),n
}function registerAccount(){var e=new Parse.User;e.set("username",document.getElementById("validEmail").value),e.set("password",document.getElementById("validPass").value),e.set("email",document.getElementById("validEmail").value),e.signUp(null,{success:function(){location="welcome.html"},error:function(e,t){202==t.code?(document.getElementById("validEmail").style.border="1px solid",document.getElementById("validEmail").style.borderColor="#b94a48",document.getElementById("emailTaken").style.display="block"):alert("Error: "+t.code+" "+t.message)}})}rg4js("apiKey","5HU2mFdkS/e5Tur8l31gcA=="),rg4js("attach",!0),rg4js("enablePulse",!0),Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h"),null==Parse.User.current()&&(location="login.html");var Habit=Parse.Object.extend("Habit"),defaultImage=Parse.Object.extend("DefaultImages");$("input[type='radio']").click(function(){var e=$(this).attr("previousValue"),t=$(this).attr("name"),n=$(this).val();"checked"==e?($(this).removeAttr("checked"),$(this).attr("previousValue",!1)):($("input[name="+t+"]:radio").attr("previousValue",!1),$(this).attr("previousValue","checked"));var o=document.getElementById("others");o.value="","one"==n?n=1:"two"==n?n=2:"three"==n&&(n=3),$("#alarm-list").empty();var s=document.getElementById("myonoffswitch");if(s.checked)for(var a=1;n>=a;a++)addAlarmToList(a)}),$("#others").change(function(){if($("input[type='radio']").removeAttr("checked"),$("#alarm-list").empty(),10>$("#others").val()&&0==$("#others").val()%1&&$("#others").val()>0){var e;e=$("#others").val();var t=document.getElementById("myonoffswitch");if(t.checked)for(var n=1;e>=n;n++)addAlarmToList(n)}}),$(function(){$(":file").change(function(){if(this.files&&this.files[0]){var e=new FileReader;e.onload=imageIsLoaded,e.readAsDataURL(this.files[0])}})}),$(window).resize(function(){if("none"!=$(".hide").css("display"))if(360>$("#form").width())$(".hide").css("display","block"),$(".hide").css("position","relative");else{$(".hide").css("position","absolute"),$(".hide").css("display","inline-block");var e=document.getElementById("addForm"),t=e.innerHTML;e.innerHTML=t}}),Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h"),null==Parse.User.current()&&(location="login.html"),rg4js("apiKey","5HU2mFdkS/e5Tur8l31gcA=="),rg4js("attach",!0),rg4js("enablePulse",!0),rg4js("setUser",{identifier:Parse.User.current().get("email"),isAnonymous:!1,email:Parse.User.current().get("email"),firstName:"Firstname",fullName:"Firstname Lastname"});var Habit=Parse.Object.extend("Habit"),defaultImage=Parse.Object.extend("DefaultImages"),hasImageChanged=!1,hasUploaded=!1;$("input[type='radio']").click(function(){var e=$(this).attr("previousValue"),t=$(this).attr("name"),n=$(this).val();"checked"==e?($(this).removeAttr("checked"),$(this).attr("previousValue",!1)):($("input[name="+t+"]:radio").attr("previousValue",!1),$(this).attr("previousValue","checked"));var o=document.getElementById("others");o.value="","one"==n?n=1:"two"==n?n=2:"three"==n&&(n=3),$("#alarm-list").empty();var s=document.getElementById("myonoffswitch");if(s.checked)for(var a=1;n>=a;a++)addAlarmToList(a)}),$("#others").change(function(){if($("input[type='radio']").removeAttr("checked"),$("#alarm-list").empty(),10>$("#others").val()&&0==$("#others").val()%1&&$("#others").val()>0){var e;e=$("#others").val();var t=document.getElementById("myonoffswitch");if(t.checked)for(var n=1;e>=n;n++)addAlarmToList(n)}}),$(function(){$(":file").change(function(){if(this.files&&this.files[0]){var e=new FileReader;e.onload=imageIsLoaded,e.readAsDataURL(this.files[0])}})}),$(window).resize(function(){if("none"!=$(".hide").css("display"))if(360>$("#form").width())$(".hide").css("display","block"),$(".hide").css("position","relative");else{$(".hide").css("position","absolute"),$(".hide").css("display","inline-block");var e=document.getElementById("editForm"),t=e.innerHTML;e.innerHTML=t}}),window.onload=onStart,Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h"),null==Parse.User.current()&&(location="login.html"),rg4js("apiKey","5HU2mFdkS/e5Tur8l31gcA=="),rg4js("attach",!0),rg4js("enablePulse",!0),rg4js("setUser",{identifier:Parse.User.current().get("email"),isAnonymous:!1,email:Parse.User.current().get("email"),firstName:"Firstname",fullName:"Firstname Lastname"});var Habit=Parse.Object.extend("Habit"),daysArray=[0,1,2,3,4,5,6],daysBoolArr=["onSunday","onMonday","onTuesday","onWednesday","onThursday","onFriday","onSaturday"];$(window).resize(function(){$(".hidden-resizer").each(function(){for($(this).css("font-size",24);$(this).width()>$(".title-li").width();){var e=parseInt($(this).css("font-size"),10);$(this).css("font-size",e-1)}})});try{loadHabits()}catch(exception){console.error("exception caught"),document.getElementById("notSupported").style.display="block"}Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h"),rg4js("apiKey","5HU2mFdkS/e5Tur8l31gcA=="),rg4js("attach",!0),rg4js("enablePulse",!0),rg4js("setUser",{identifier:"users_email_address_or_unique_id@domain.com",isAnonymous:!1,email:"users_email_address@domain.com",firstName:"Firstname",fullName:"Firstname Lastname"});var isPushEnabled=!1;window.addEventListener("load",function(){var e=document.querySelector(".onoffswitch-checkbox"),t=location.protocol;"https:"!==t&&(document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block",document.getElementById("noNotifications").textContent="Notifications only work over secure HTTPS."),e.addEventListener("click",function(e){console.log("switched"),e.target.checked&&subscribe()}),"serviceWorker"in navigator?navigator.serviceWorker.register("../worker.js").then(initialiseState):(console.warn("Service workers aren't supported in this browser."),document.querySelector(".onoffswitch-checkbox").setAttribute("disabled",!0),document.getElementById("noNotifications").style.display="block")}),Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h"),Parse.initialize("Ih70t530LwJAnRJungwuPtE2nE3eakzmwVuZHb6O","sE6Y6iMcoTTa9Z3pBCaAtwnD9F1L9SlWHBKlDQ7h");